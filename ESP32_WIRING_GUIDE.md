# ESP32スロット制御システム - 配線ガイド

## 必要部品
- ESP32開発ボード（Freenove ESP32）
- SG90サーボモーター
- プッシュボタンスイッチ（小型）
- ブレッドボードとジャンパワイヤ

## 配線図

### ESP32ピン配置
```
ESP32              接続先
GPIO18      ←→     サーボモーターの信号線（オレンジ/黄色）
GPIO2       ←→     プッシュボタンの一端
5V          ←→     サーボモーターの電源線（赤）
GND         ←→     サーボモーターのGND線（茶色/黒）+ ボタンのもう一端
```

### 詳細配線手順

#### 1. サーボモーター接続
- 赤線（電源） → ESP32の5V
- 茶/黒線（GND） → ESP32のGND  
- オレンジ/黄線（信号） → ESP32のGPIO18

#### 2. プッシュボタン接続
- ボタンの一端 → ESP32のGPIO2
- ボタンのもう一端 → ESP32のGND
- ※内蔵プルアップ抵抗使用のため外部抵抗不要

## 動作説明

### ボタン操作
- 短押し: サーボ有効/無効を切り替え
- デバウンス処理により誤動作を防止
- 現在の状態はシリアルモニタで確認可能

### BLE通信
- アプリから「PRESS」コマンド受信時:
  - サーボ有効: ボタンプレス実行 → 「PRESS_COMPLETE」応答
  - サーボ無効: 動作スキップ → 「SERVO_DISABLED」応答

## コード書き込み手順

1. Arduino IDEを開く
2. `esp32_slot_controller_with_button.ino`を開く
3. ツール → ボード → ESP32 Arduino → ESP32 Dev Moduleを選択
4. ツール → ポート → 対応するCOMポートを選択
5. 書き込みボタン（→）をクリック

## トラブルシューティング

### ボタンが効かない場合
- GPIO2とGNDの接続を確認
- ボタンの接触不良をチェック

### サーボが動かない場合
- 5V電源接続を確認
- GPIO18への信号線接続を確認
- シリアルモニタで「ボタンプレス実行開始」メッセージを確認

### BLE接続できない場合
- シリアルモニタで「BLEサーバー開始完了」メッセージを確認
- アプリ側でESP32SlotControllerが表示されるか確認